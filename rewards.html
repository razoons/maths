<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8" />
    <title>Jeux de Maths</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cherry+Bomb+One&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/vuetify@3.5.4/dist/vuetify.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vuetify@3.5.4/dist/vuetify.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div id="app">
        <v-app>
            <v-main class="pa-4 d-flex flex-column align-stretch justify-center h-100"
                style="background-color:#0aaee3;color:white">
                <!-- Row 1 -->
                <div class="flex-grow-1 p-16 d-flex flex-row align-center justify-start">
                    <img src="./etoile.png" style="height:500px" />
                    <span class="text-h1 font-kid">x{{stars}}</span>
                </div>
                <div class="flex-grow-1 p-4 d-flex flex-row align-center justify-start">
                    <img src="./fee.png" style="height:500px" />
                    <span class="text-h1 font-kid">x{{fairies}}</span>
                </div>
                <div class="flex-grow-1 ma-4 d-flex flex-row align-center justify-start">
                    <img src="./licorne.png" style="height:500px" />
                    <span class="text-h1 font-kid">x{{unicorns}}</span>
                </div>

                <div class="flex-grow-1 d-flex align-center justify-center">
                    <v-btn size="x-large" rounded="pill"
                        class="h-auto border-lg d-flex text-h1 elevation-24 ma-auto w-90 font-kid" @click="goToGame"
                        color="#f78d17">
                        Revenir au menu
                    </v-btn>
                </div>
            </v-main>
        </v-app>
    </div>
    <script>
        const { createApp, ref, onMounted } = Vue;
        const { createVuetify } = Vuetify;

        const app = createApp({
            setup() {
                const rewards = JSON.parse(localStorage.getItem('rewards')) || { stars: 0, fairies: 0, unicorns: 0 };
                const stars = ref(rewards.stars);
                const fairies = ref(rewards.fairies);
                const unicorns = ref(rewards.unicorns);

                function goToGame() {
                    window.location.href = './index.html';
                }

                return { goToGame, stars, fairies, unicorns };
            }
        });

        const vuetify = createVuetify();
        app.use(vuetify);
        app.mount('#app');
    </script>
    <script>
        if ("serviceWorker" in navigator) {
            window.addEventListener("load", async () => {
                try {
                    const reg = await navigator.serviceWorker.register("./service-worker.js", { scope: "/" });
                    // (optionnel) auto-update du SW
                    setInterval(() => reg.update(), 60 * 60 * 1000); // toutes les heures

                    // (optionnel) activer la nouvelle version immédiatement
                    navigator.serviceWorker.addEventListener("controllerchange", () => {
                        // tu peux rafraîchir l’UI ici si besoin
                    });
                } catch (e) {
                    console.error("SW registration failed", e);
                }
            });
        }
    </script>
</body>

</html>